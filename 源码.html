<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>暖心礼物❤️</title>
    <!-- Umami 统计追踪代码（正常生效） -->
    <script defer src="https://cloud.umami.is/script.js" data-website-id="75d9443c-d127-474a-8083-a5f07aca5b8c"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, #ffafbd, #ffc3a0); min-height: 100vh; overflow: hidden; color: #5a3e36; transition: background 3s ease; }
        
        /* 公告页（默认显示，无版本号） */
        .notice-page { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 30px; text-align: center; background: rgba(255, 255, 255, 0.9); z-index: 100; position: relative; }
        .notice-content { max-width: 600px; background: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); }
        .notice-title { font-size: 2.2rem; margin-bottom: 20px; color: #e74c3c; }
        .notice-text { font-size: 1.2rem; line-height: 1.6; margin-bottom: 30px; color: #5a3e36; }
        .notice-text strong { color: #e74c3c; font-weight: 600; }
        .countdown { font-size: 1.5rem; margin-bottom: 30px; color: #e74c3c; font-weight: bold; }
        .enter-btn { background: #e74c3c; color: white; border: none; padding: 12px 30px; border-radius: 30px; font-size: 1.1rem; cursor: pointer; transition: all 0.3s ease; opacity: 0.5; pointer-events: none; }
        .enter-btn.active { opacity: 1; pointer-events: auto; }
        .enter-btn:hover { background: #c0392b; transform: translateY(-2px); }
        
        /* 礼物页（默认隐藏） */
        .gift-page { display: none; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; transition: opacity 0.8s ease, transform 0.8s ease; }
        .container { text-align: center; max-width: 800px; width: 100%; }
        h1 { font-size: 2.8rem; margin-bottom: 10px; color: #8b4513; text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1); }
        .subtitle { font-size: 1.2rem; margin-bottom: 40px; color: #7a5c4d; }
        .gift-container { position: relative; width: 200px; height: 200px; margin: 0 auto 50px; cursor: pointer; transition: transform 0.3s ease; animation: float 3s ease-in-out infinite; }
        .gift-container:hover { transform: scale(1.05); }
        .gift-box { width: 100%; height: 100%; background: linear-gradient(135deg, #e74c3c, #c0392b); border-radius: 10px; position: relative; box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); transition: all 0.5s ease; }
        .gift-box::before { content: ''; position: absolute; width: 100%; height: 20px; background: rgba(255, 255, 255, 0.3); top: 50%; left: 0; transform: translateY(-50%); }
        .gift-box::after { content: ''; position: absolute; width: 20px; height: 100%; background: rgba(255, 255, 255, 0.3); left: 50%; top: 0; transform: translateX(-50%); }
        .gift-bow { position: absolute; top: -10px; left: 50%; transform: translateX(-50%); width: 40px; height: 40px; background: #ff6b6b; border-radius: 50%; z-index: 2; }
        .gift-bow::before, .gift-bow::after { content: ''; position: absolute; width: 60px; height: 20px; background: #ff6b6b; border-radius: 10px; top: 10px; }
        .gift-bow::before { left: -70px; transform: rotate(-45deg); }
        .gift-bow::after { right: -70px; transform: rotate(45deg); }
        .instructions { margin-top: 30px; font-style: italic; color: #7a5c4d; }
        .footer { margin-top: 50px; color: #7a5c4d; font-size: 0.9rem; }
        
        /* 消息页（默认隐藏） */
        .messages-page { display: none; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; opacity: 0; transition: opacity 0.8s ease; position: relative; overflow: hidden; }
        .messages-container { position: relative; width: 100%; height: 100vh; display: flex; align-items: center; justify-content: center; }
        .message { position: absolute; background: rgba(255, 255, 255, 0.9); padding: 25px 40px; border-radius: 30px; font-size: 1.5rem; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15); opacity: 0; transition: opacity 0.6s ease, transform 0.6s ease; line-height: 1.5; max-width: 600px; text-align: center; z-index: 1; transform: translateY(20px); }
        .message.active { opacity: 1; transform: translateY(0); }
        .message i { color: #e74c3c; margin-right: 10px; font-size: 1.8rem; }
        .message-counter { position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); background: rgba(255, 255, 255, 0.7); padding: 8px 20px; border-radius: 20px; font-size: 1rem; color: #7a5c4d; }
        .back-btn { position: absolute; top: 30px; right: 30px; background: rgba(255, 255, 255, 0.8); border: none; padding: 12px 25px; border-radius: 30px; font-size: 1rem; color: #8b4513; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1); z-index: 10; }
        .back-btn:hover { background: white; transform: translateY(-3px); box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15); }
        
        /* 动画效果 */
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .pulse { animation: pulse 0.5s ease-in-out; }
        
        /* 移动端适配 */
        @media (max-width: 768px) {
            .notice-title { font-size: 1.8rem; }
            .notice-text { font-size: 1rem; }
            h1 { font-size: 2.2rem; }
            .gift-container { width: 150px; height: 150px; }
            .message { font-size: 1.3rem; max-width: 500px; padding: 20px 30px; }
            .message i { font-size: 1.5rem; }
            .back-btn { top: 20px; right: 20px; padding: 10px 20px; }
        }
        @media (max-width: 480px) {
            .notice-title { font-size: 1.5rem; }
            .notice-text { font-size: 0.9rem; }
            h1 { font-size: 1.8rem; }
            .subtitle { font-size: 1rem; }
            .gift-container { width: 120px; height: 120px; }
            .message { font-size: 1.1rem; max-width: 350px; padding: 15px 25px; margin: 0 15px; }
            .message i { font-size: 1.3rem; }
            .back-btn { top: 15px; right: 15px; padding: 8px 16px; font-size: 0.9rem; }
        }
        
        /* 版本号样式（默认隐藏，仅对应页面显示） */
        .version-info { 
            position: fixed; bottom: 20px; right: 20px; text-align: right; 
            color: #7a5c4d; z-index: 9; display: none; /* 初始强制隐藏 */
        }
        .visitor-count { font-size: 0.9rem; margin-bottom: 2px; opacity: 0.95; }
        .version { font-size: 0.95rem; margin-bottom: 2px; }
        .author { font-size: 0.75rem; opacity: 0.9; }
        /* 移动端版本号适配 */
        @media (max-width: 480px) {
            .version-info { bottom: 60px; right: 15px; }
            .visitor-count { font-size: 0.8rem; }
            .version { font-size: 0.85rem; }
            .author { font-size: 0.65rem; }
        }
    </style>
</head>
<body>
    <!-- 公告页（无版本号元素，彻底杜绝显示） -->
    <div class="notice-page" id="noticePage">
        <div class="notice-content">
            <h2 class="notice-title">使用须知</h2>
            <div class="notice-text">
                <p>欢迎使用暖心礼物网站！在使用前请阅读以下重要提示：</p>
                <p><strong>1. 请勿将此网站用于商业用途或圈钱行为</strong></p>
                <p><strong>2. 请勿对网站进行二次修改并声称是原创作品</strong></p>
                <p><strong>3. bug反馈/语录提供:15259955231@163.com   xiaojianxiang816@gmail.com</strong></p>
                <p>本网站旨在传播温暖与正能量，希望大家能够尊重原创，共同维护良好的网络环境</p>
            </div>
            <div class="countdown" id="countdown">5</div>
            <button class="enter-btn" id="enterBtn" disabled>阅读5秒后进入</button>
        </div>
    </div>
    
    <!-- 礼物页（含版本号，默认隐藏） -->
    <div class="gift-page" id="giftPage">
        <div class="container">
            <h1>暖心礼物盒</h1>
            <p class="subtitle">点击礼物盒，收获温暖的安慰话语</p>
            <div class="gift-container" id="giftBox">
                <div class="gift-box">
                    <div class="gift-bow"></div>
                </div>
            </div>
            <p class="instructions">每一句温暖的话语都是给你的小小安慰</p>
            <div class="footer">
                <p>制作者大魔王 希望这些话语能给你带来一丝温暖</p>
            </div>
        </div>
        <!-- 礼物页专属版本号（初始隐藏，进入后显示） -->
        <div class="version-info" id="versionGift">
            <div class="visitor-count" id="visitorCount">总访问量：加载中... | 今日：加载中...</div>
            <div class="version">当前版本号ⅴ1.1.1</div>
            <div class="author">大魔王.by</div>
        </div>
    </div>
    
    <!-- 消息页（含版本号，默认隐藏） -->
    <div class="messages-page" id="messagesPage">
        <div class="messages-container" id="messagesContainer"></div>
        <div class="message-counter" id="messageCounter">1 / 60</div>
        <button class="back-btn" id="backBtn">返回礼物盒</button>
        <!-- 消息页专属版本号（初始隐藏，进入后显示） -->
        <div class="version-info" id="versionMsg">
            <div class="visitor-count" id="visitorCountMsg">总访问量：加载中... | 今日：加载中...</div>
            <div class="version">当前版本号ⅴ1.1.1</div>
            <div class="author">大魔王.by</div>
        </div>
    </div>

    <script>
        // 页面核心元素
        const noticePage = document.getElementById('noticePage');
        const giftPage = document.getElementById('giftPage');
        const messagesPage = document.getElementById('messagesPage');
        const countdownElement = document.getElementById('countdown');
        const enterBtn = document.getElementById('enterBtn');
        const giftBox = document.getElementById('giftBox');
        const messagesContainer = document.getElementById('messagesContainer');
        const messageCounter = document.getElementById('messageCounter');
        const backBtn = document.getElementById('backBtn');
        // 版本号元素（分页面单独控制，彻底隔离公告页）
        const versionGift = document.getElementById('versionGift');
        const versionMsg = document.getElementById('versionMsg');
        const visitorCount = document.getElementById('visitorCount');
        const visitorCountMsg = document.getElementById('visitorCountMsg');
        
        // 倒计时核心变量（三重加固，确保不失效）
        let countdown = 5;
        let countdownInterval = null;
        
        // 消息相关变量
        let isOpened = false;
        let messageInterval = null;
        let currentMessageIndex = 0;
        
        // 安慰话语数组（完整60条）
        const comfortingMessages = [
            "你并不孤单，我在这里陪着你",
            "每一天都是新的开始，明天会更好",
            "你的感受很重要，我完全理解",
            "风雨过后，总会有美丽的彩虹",
            "你比想象中要坚强得多",
            "慢慢来，给自己一些时间和空间",
            "你的存在本身就是一种美好",
            "不必完美，做真实的自己就足够",
            "一切都会慢慢好起来的，我相信",
            "你是被爱着的，永远都是",
            "每一个艰难时刻都会过去",
            "你的价值不因任何事而改变",
            "允许自己感受所有情绪，这很正常",
            "小小的进步也是值得庆祝的",
            "你已经在做得很好了",
            "黑暗过后，光明必将到来",
            "对自己温柔一点，你值得被善待",
            "你的坚强和韧性令人敬佩",
            "每一天都是重新开始的机会",
            "你拥有改变一切的内在力量",
            "困难只是暂时的，你会克服的",
            "给自己一个拥抱，你已经很努力了",
            "相信时间的力量，一切都会过去",
            "你的独特之处正是你的魅力所在",
            "不要害怕寻求帮助，我们都在一起",
            "每一次跌倒都是为了更好地站起来",
            "你的笑容是世界上最美的风景",
            "内心的平静比外在的成功更重要",
            "你是自己生命的主角，编写精彩故事",
            "无论发生什么，都不要放弃希望",
            "你的存在让这个世界变得更美好",
            "每一天都是新的机会，新的开始",
            "你的内心有无限的力量和勇气",
            "相信自己的直觉和判断",
            "你是独一无二的，没有人能替代",
            "给自己一点时间，一切都会好起来",
            "你的努力和坚持值得被看见",
            "不要对自己太苛刻，你已经很棒了",
            "你的善良和温暖感染着周围的人",
            "每一天都是成长和学习的机会",
            "你的心是柔软的，但也是坚强的",
            "即使感到迷茫，也要相信前方有光",
            "你的故事值得被倾听，你的声音值得被听见",
            "给自己一点温柔，就像对待最好的朋友",
            "每一个小小的进步都值得骄傲",
            "你的内心有治愈自己的力量",
            "不必急着赶路，偶尔停下来看看风景也很好",
            "你的存在本身就是一份珍贵的礼物",
            "即使感到脆弱，那也是人性的一部分",
            "你的勇气比恐惧更强大",
            "给自己一个深呼吸的空间，一切都会清晰",
            "你的感受是真实的，值得被尊重",
            "每一个日出都是重新开始的机会",
            "你的内在光芒会照亮前行的路",
            "即使现在很难，也要相信未来会更好",
            "你的善良会以另一种方式回到你身边",
            "给自己一点耐心，成长需要时间",
            "你的眼泪也是坚强的一部分",
            "即使感到孤独，也要记得有人在乎你",
            "你的每一步都在向前，无论大小"
        ];

        // 实时访问量获取（和Umami同步）
        async function getUmamiVisitorCount() {
            const websiteId = "75d9443c-d127-474a-8083-a5f07aca5b8c";
            const apiUrl = `https://cloud.umami.is/api/website/${websiteId}/stats`;
            
            try {
                const response = await fetch(apiUrl, { method: 'GET', headers: { 'Accept': 'application/json' } });
                if (!response.ok) throw new Error('访问量加载失败');
                
                const data = await response.json();
                const total = data.stats.total || 0;
                const today = data.stats.today || 0;
                
                visitorCount.textContent = `总访问量：${total} | 今日：${today}`;
                visitorCountMsg.textContent = `总访问量：${total} | 今日：${today}`;
            } catch (e) {
                visitorCount.textContent = `总访问量：-- | 今日：--`;
                visitorCountMsg.textContent = `总访问量：-- | 今日：--`;
            }
        }

        // 倒计时功能（彻底修复，100%生效）
        function startCountdown() {
            // 强制重置状态，避免任何冲突
            clearInterval(countdownInterval);
            countdown = 5;
            countdownElement.innerText = countdown;
            enterBtn.disabled = true;
            enterBtn.classList.remove('active');
            enterBtn.innerText = '阅读5秒后进入';
            
            // 启动倒计时，每秒减1
            countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.innerText = countdown;
                
                // 倒计时结束，激活按钮
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    enterBtn.disabled = false;
                    enterBtn.classList.add('active');
                    enterBtn.innerText = '进入网站';
                }
            }, 1000);
        }

        // 消息轮播功能
        function startMessageRotation() {
            createMessage();
            messageInterval = setInterval(() => {
                const activeMsg = document.querySelector('.message.active');
                if (activeMsg) {
                    activeMsg.style.opacity = 0;
                    activeMsg.style.transform = 'translateY(-20px)';
                    setTimeout(() => activeMsg.remove(), 600);
                }
                
                currentMessageIndex = (currentMessageIndex + 1) % comfortingMessages.length;
                messageCounter.innerText = `${currentMessageIndex + 1} / ${comfortingMessages.length}`;
                setTimeout(createMessage, 300);
            }, 2000);
        }

        // 创建单条消息
        function createMessage() {
            const msg = document.createElement('div');
            msg.className = 'message';
            msg.innerHTML = `<i class="fas fa-heart"></i> ${comfortingMessages[currentMessageIndex]}`;
            messagesContainer.appendChild(msg);
            setTimeout(() => msg.classList.add('active'), 100);
        }

        // 页面切换事件：公告页 → 礼物页
        enterBtn.addEventListener('click', () => {
            noticePage.style.display = 'none';
            giftPage.style.display = 'flex';
            versionGift.style.display = 'block'; // 只在礼物页显示版本号
            getUmamiVisitorCount(); // 刷新访问量
        });

        // 页面切换事件：礼物页 → 消息页
        giftBox.addEventListener('click', () => {
            if (isOpened) return;
            isOpened = true;
            giftBox.classList.add('pulse');
            
            setTimeout(() => {
                giftPage.style.opacity = 0;
                setTimeout(() => {
                    giftPage.style.display = 'none';
                    messagesPage.style.display = 'flex';
                    versionGift.style.display = 'none'; // 隐藏礼物页版本号
                    versionMsg.style.display = 'block'; // 显示消息页版本号
                    startMessageRotation();
                    setTimeout(() => messagesPage.style.opacity = 1, 100);
                }, 800);
            }, 500);
        });

        // 页面切换事件：消息页 → 礼物页
        backBtn.addEventListener('click', () => {
            clearInterval(messageInterval);
            messagesPage.style.opacity = 0;
            messagesContainer.innerHTML = '';
            
            setTimeout(() => {
                messagesPage.style.display = 'none';
                giftPage.style.display = 'flex';
                versionMsg.style.display = 'none'; // 隐藏消息页版本号
                versionGift.style.display = 'block'; // 显示礼物页版本号
                setTimeout(() => {
                    giftPage.style.opacity = 1;
                    isOpened = false;
                    currentMessageIndex = 0;
                    messageCounter.innerText = `1 / ${comfortingMessages.length}`;
                }, 100);
            }, 800);
        });

        // 页面加载完成后，优先启动倒计时（确保第一时间执行）
        window.onload = () => {
            startCountdown();
            messageCounter.innerText = `1 / ${comfortingMessages.length}`;
            getUmamiVisitorCount();
            setInterval(getUmamiVisitorCount, 180000); // 每3分钟刷新访问量
        };
    </script>
</body>
</html>